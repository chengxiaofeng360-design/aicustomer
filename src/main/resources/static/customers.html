<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客户档案管理 - AI客户管理系统</title>
    <link href="/lib/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="/lib/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="/css/common.css" rel="stylesheet">
</head>
<body>
    <div class="main-container">
        <!-- 页面头部 -->
        <div class="page-header">
            <div class="page-title">
                <i class="bi bi-people-fill"></i> 客户档案管理
            </div>
            <a href="/" class="back-home-btn">
                <i class="bi bi-house-fill"></i> 返回首页
            </a>
        </div>
        
        <!-- 统计卡片 -->
        <div class="row mb-3">
            <div class="col-md-3">
                <div class="stats-card" style="padding: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                    <div>
                        <div class="stats-label" style="font-size: 0.9rem; margin-bottom: 0.25rem;">客户总数</div>
                        <div id="statsTotalCustomers" class="stats-number" style="font-size: 1.5rem; font-weight: bold;">0</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card" style="padding: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                    <div>
                        <div class="stats-label" style="font-size: 0.9rem; margin-bottom: 0.25rem;">重要用户</div>
                        <div id="statsSatisfaction" class="stats-number" style="font-size: 1.5rem; font-weight: bold;">-</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card" style="padding: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                    <div>
                        <div class="stats-label" style="font-size: 0.9rem; margin-bottom: 0.25rem;">本月新增</div>
                        <div id="statsNewThisMonth" class="stats-number" style="font-size: 1.5rem; font-weight: bold;">0</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card" style="padding: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                    <div>
                        <div class="stats-label" style="font-size: 0.9rem; margin-bottom: 0.25rem;">潜在客户</div>
                        <div id="statsPotentialCustomers" class="stats-number" style="font-size: 1.5rem; font-weight: bold;">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 搜索和筛选区域 -->
        <div class="card mb-3">
              <div class="card-body">
                <!-- 切换搜索区域显示/隐藏的按钮（横向窄倒三角） -->
                <div style="margin: 0; padding: 0;">
                    <button class="btn p-0" style="min-width: 14px; padding: 0; width: 14px; height: 14px; display: flex; align-items: center; justify-content: center; border: none; background: none;" onclick="toggleSearchPanel()" id="toggleButton">
                        <i class="bi bi-chevron-down" style="font-size: 0.65rem; color: #495057;"></i>
                    </button>
                </div>
                
                <!-- 搜索和操作按钮区域（初始隐藏） -->
                <div id="searchPanel" style="display: none;">
                <!-- 第一排：搜索条件 -->
                <div class="row g-3 mb-3">
                    <div class="col-md-3">
                        <label class="form-label">客户名称</label>
                        <input type="text" class="form-control" id="customerName" placeholder="请输入客户名称...">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">客户类型</label>
                        <select class="form-select" id="customerType">
                            <option value="">全部</option>
                            <option value="个人">个人</option>
                            <option value="企业">企业</option>
                            <option value="科研院所">科研院所</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">客户等级</label>
                        <select class="form-select" id="customerLevel">
                            <option value="">全部</option>
                            <option value="普通">普通</option>
                            <option value="VIP">VIP</option>
                            <option value="钻石">钻石</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">地区</label>
                        <select class="form-select" id="region">
                            <option value="">全部</option>
                            <option value="北京">北京</option>
                            <option value="上海">上海</option>
                            <option value="广东">广东</option>
                            <option value="江苏">江苏</option>
                        </select>
                    </div>
                </div>
                
                <!-- 第二排：操作按钮 -->
                <div class="row">
                    <div class="col-12">
                        <div class="d-flex flex-wrap gap-2 justify-content-between">
                            <div class="operation-buttons">
                                <button class="btn btn-success" onclick="showAddCustomerModal()">
                                    <i class="bi bi-plus-circle"></i> 新增客户
                                </button>
                            <button class="btn btn-info" onclick="showAIRecognition()">
                                <i class="bi bi-robot"></i> AI识别
                            </button>
                            <button class="btn btn-success" onclick="showFileUpload()">
                                <i class="bi bi-upload"></i> 批量导入
                            </button>
                            <button class="btn btn-info" onclick="downloadTemplate()">
                                <i class="bi bi-file-earmark-arrow-down"></i> 下载模版
                            </button>
                                <button class="btn btn-warning" onclick="exportCustomers()">
                                    <i class="bi bi-download"></i> 导出数据
                                </button>
                            </div>
                            <div class="operation-buttons">
                                <button class="btn btn-primary" onclick="searchCustomers()">
                                    <i class="bi bi-search"></i> 搜索
                                </button>
                                <button class="btn btn-secondary" onclick="resetFilters()">
                                    <i class="bi bi-arrow-clockwise"></i> 重置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                </div> <!-- 结束搜索面板容器 -->
                
                <!-- JavaScript 切换逻辑 -->
                <script>
                function toggleSearchPanel() {
                    const panel = document.getElementById('searchPanel');
                    const toggleIcon = document.querySelector('#toggleButton i');
                    if (panel.style.display === 'none' || panel.style.display === '') {
                        panel.style.display = 'block';
                        toggleIcon.classList.remove('bi-chevron-down');
                        toggleIcon.classList.add('bi-chevron-up');
                    } else {
                        panel.style.display = 'none';
                        toggleIcon.classList.remove('bi-chevron-up');
                        toggleIcon.classList.add('bi-chevron-down');
                    }
                }
                </script>
            </div>
        </div>

        <!-- 记录统计信息 - 移到右下角 -->
        <div class="position-fixed" style="bottom: 20px; right: 20px; z-index: 1000;">
            <span class="badge bg-secondary fs-6">共 <span id="totalCustomers">0</span> 条记录</span>
        </div>

        <!-- 客户列表 -->
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>客户名称</th>
                                <th>联系人</th>
                                <th>电话</th>
                                <th>客户类型</th>
                                <th>客户等级</th>
                                <th>职务</th>
                                <th>敏感状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="customerTableBody">
                            <!-- 客户数据将通过JavaScript动态加载 -->
                        </tbody>
                    </table>
                </div>
                <!-- 分页控件 -->
                <div class="d-flex justify-content-between align-items-center mt-3" id="paginationContainer">
                    <div class="text-muted">
                        <span id="paginationInfo">共 0 条记录，当前显示第 0-0 条</span>
                    </div>
                    <nav aria-label="客户列表分页">
                        <ul class="pagination mb-0" id="paginationNav">
                            <!-- 分页按钮将通过JavaScript动态生成 -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- 新增/编辑客户模态框 -->
    <div class="modal fade" id="customerModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="customerModalTitle">新增客户</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="customerForm">
                        <input type="hidden" id="customerId" name="id">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="customerNameInput">客户名称</label>
                                    <input type="text" class="form-control" id="customerNameInput" name="customerName" required placeholder="请输入客户名称">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="contactPerson">联系人</label>
                                    <input type="text" class="form-control" id="contactPerson" name="contactPerson" required placeholder="请输入联系人姓名">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="phone">电话</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" required placeholder="请输入联系电话">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="email">邮箱</label>
                                    <input type="email" class="form-control" id="email" name="email" placeholder="请输入邮箱地址">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="customerTypeSelect">客户类型</label>
                                    <select class="form-select" id="customerTypeSelect" name="customerType" required>
                                        <option value="">请选择客户类型</option>
                                        <option value="个人">个人</option>
                                        <option value="企业">企业</option>
                                        <option value="科研院所">科研院所</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="customerLevelSelect">客户等级</label>
                                    <select class="form-select" id="customerLevelSelect" name="customerLevel" required>
                                        <option value="">请选择客户等级</option>
                                        <option value="普通" selected>普通</option>
                                        <option value="VIP">VIP</option>
                                        <option value="钻石">钻石</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="regionSelect">地区</label>
                                    <select class="form-select" id="regionSelect" name="region" required>
                                        <option value="">请选择地区</option>
                                        <option value="北京">北京</option>
                                        <option value="上海">上海</option>
                                        <option value="广东">广东</option>
                                        <option value="江苏">江苏</option>
                                        <option value="浙江">浙江</option>
                                        <option value="山东">山东</option>
                                        <option value="河南">河南</option>
                                        <option value="四川">四川</option>
                                        <option value="湖北">湖北</option>
                                        <option value="湖南">湖南</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="position">职务</label>
                                    <input type="text" class="form-control" id="position" name="position" placeholder="请输入职务">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label" for="qqWeixin">QQ/微信</label>
                                    <input type="text" class="form-control" id="qqWeixin" name="qqWeixin" placeholder="请输入QQ号或微信号">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label class="form-label" for="cooperationContent">合作内容</label>
                                    <textarea class="form-control" id="cooperationContent" name="cooperationContent" rows="3" placeholder="请输入合作内容"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label class="form-label" for="address">详细地址</label>
                                    <textarea class="form-control" id="address" name="address" rows="2" placeholder="请输入详细地址"></textarea>
                                </div>
                            </div>
                        </div>
                                <div class="row">
                            <div class="col-md-12">
                                        <div class="mb-3">
                                    <label class="form-label" for="remarks">备注</label>
                                    <textarea class="form-control" id="remarks" name="remarks" rows="3" placeholder="请输入备注信息"></textarea>
                                        </div>
                                    </div>
                                        </div>
                    </form>
                                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> 取消
                    </button>
                    <button type="button" class="btn btn-primary" onclick="saveCustomer()">
                        <i class="bi bi-check-circle"></i> 保存
                    </button>
                                        </div>
                                    </div>
                                        </div>
                                    </div>

    <!-- 客户详情模态框 -->
    <div class="modal fade" id="customerDetailModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">客户详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                <div class="modal-body">
                    <!-- 标签页导航 -->
                    <ul class="nav nav-tabs mb-3" id="customerDetailTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="basicInfoTab" data-bs-toggle="tab" data-bs-target="#basicInfo" type="button" role="tab">
                                <i class="bi bi-info-circle me-1"></i>基本信息
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="communicationsTab" data-bs-toggle="tab" data-bs-target="#communications" type="button" role="tab">
                                <i class="bi bi-chat-dots me-1"></i>沟通记录
                            </button>
                        </li>
                    </ul>
                    
                    <!-- 标签页内容 -->
                    <div class="tab-content" id="customerDetailTabContent">
                        <!-- 基本信息标签页 -->
                        <div class="tab-pane fade show active" id="basicInfo" role="tabpanel">
                            <div id="customerDetailContent"></div>
                        </div>
                        <!-- 沟通记录标签页 -->
                        <div class="tab-pane fade" id="communications" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="mb-0">沟通记录列表</h6>
                                <button class="btn btn-sm btn-primary" id="addCommunicationBtn" onclick="showAddCommunicationForCurrentCustomer()">
                                    <i class="bi bi-plus"></i> 新增沟通记录
                                </button>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>沟通类型</th>
                                            <th>沟通主题</th>
                                            <th>重要程度</th>
                                            <th>沟通时间</th>
                                            <th>操作人</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customerCommunicationTableBody">
                                        <tr>
                                            <td colspan="6" class="text-center text-muted">点击上方"基本信息"标签查看客户信息</td>
                                        </tr>
                                    </tbody>
                                </table>
                                        </div>
                                    </div>
                                        </div>
                                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
    <!-- 新增/编辑沟通记录模态框 -->
    <div class="modal fade" id="communicationModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="communicationModalTitle">新增沟通记录</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                <div class="modal-body">
                    <form id="communicationForm">
                        <input type="hidden" id="communicationId" name="id">
                                <input type="hidden" id="customerIdHidden">
                                <div class="row">
                            <div class="col-md-6">
                                        <div class="mb-3">
                                    <label class="form-label">沟通类型 *</label>
                                    <select class="form-select" id="communicationTypeSelect" name="communicationType" required>
                                        <option value="">请选择类型</option>
                                        <option value="1">电话</option>
                                        <option value="2">邮件</option>
                                        <option value="3">微信</option>
                                        <option value="4">面谈</option>
                                        <option value="5">其他</option>
                                    </select>
                                        </div>
                                    </div>
                                        </div>
                                <div class="row">
                            <div class="col-md-6">
                                        <div class="mb-3">
                                    <label class="form-label">重要程度 *</label>
                                    <select class="form-select" id="importanceSelect" name="importance" required>
                                        <option value="">请选择重要程度</option>
                                        <option value="1">高</option>
                                        <option value="2">中</option>
                                        <option value="3">低</option>
                                    </select>
                                        </div>
                                    </div>
                            <div class="col-md-6">
                                        <div class="mb-3">
                                    <label class="form-label">沟通时间 *</label>
                                    <input type="datetime-local" class="form-control" id="communicationTime" name="communicationTime" required>
                                        </div>
                                    </div>
                                </div>
                                        <div class="mb-3">
                            <label class="form-label">沟通主题 *</label>
                            <input type="text" class="form-control" id="subject" name="subject" required placeholder="请输入沟通主题...">
                                        </div>
                                        <div class="mb-3">
                            <label class="form-label">沟通内容 *</label>
                            <textarea class="form-control" id="content" name="content" rows="4" required placeholder="请详细描述沟通内容..."></textarea>
                                        </div>
                                        <div class="mb-3">
                            <label class="form-label">后续跟进</label>
                            <textarea class="form-control" id="followUp" name="followUp" rows="3" placeholder="后续跟进计划..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveCommunication()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 沟通记录详情模态框 -->
    <div class="modal fade" id="communicationDetailModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">沟通记录详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="communicationDetailContent">
                    <!-- 沟通记录详情内容将通过JavaScript动态加载 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AI识别模态框 -->
    <div class="modal fade" id="aiRecognitionModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-robot me-2"></i>AI智能识别客户信息
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <h6><i class="bi bi-info-circle"></i> 使用说明：</h6>
                        <ul class="mb-0">
                            <li>支持从Excel、Word等文档中复制数据直接粘贴</li>
                            <li>每行一个客户，字段用制表符或逗号分隔</li>
                            <li>必填字段：客户名称、联系人、电话、客户类型、地区</li>
                            <li>系统会自动识别和整理数据格式</li>
                        </ul>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">数据格式示例：</label>
                        <div class="bg-light p-3 rounded">
                            <code>
                                张三公司 | 李四 | 13800138000 | 企业客户 | 新品种申请 | 北京 | 农业 | 1000万<br>
                                王五农场 | 赵六 | 13900139000 | 个人客户 | 品种权申请 | 上海 | 种植业 | 500万
                            </code>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">客户数据录入：</label>
                        <div class="input-group">
                            <textarea class="form-control" id="batchImportData" rows="10" 
                                      placeholder="请在此处粘贴客户数据，或使用语音录入功能..."></textarea>
                            <div class="input-group-append">
                                <button class="btn btn-outline-success" type="button" onclick="startVoiceInput()" id="voiceInputBtn">
                                    <i class="bi bi-mic"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mt-2">
                            <small class="text-muted">
                                <i class="bi bi-info-circle"></i> 
                                支持语音录入，直接说"木木"开始录音，停顿5秒自动结束
                            </small>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="parseImportData()">
                                <i class="bi bi-gear"></i> 解析数据
                            </button>
                            <button class="btn btn-outline-secondary" onclick="clearImportData()">
                                <i class="bi bi-trash"></i> 清空
                            </button>
                            <button class="btn btn-outline-info" onclick="showVoiceHelp()">
                                <i class="bi bi-question-circle"></i> 语音帮助
                            </button>
                        </div>
                    </div>

                    <!-- 语音录入状态显示 -->
                    <div id="voiceStatus" class="alert alert-info" style="display: none;">
                        <div class="d-flex align-items-center">
                            <div class="spinner-border spinner-border-sm me-2" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <span id="voiceStatusText">正在听取语音...</span>
                        </div>
                    </div>

                    <div id="importPreview" style="display: none;">
                        <h6>数据预览：</h6>
                        <div class="table-responsive">
                            <table class="table table-sm table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>客户名称</th>
                                        <th>联系人</th>
                                        <th>电话</th>
                                        <th>客户类型</th>
                                        <th>职务</th>
                                        <th>QQ/微信</th>
                                        <th>合作内容</th>
                                        <th>地区</th>
                                        <th>状态</th>
                                    </tr>
                                </thead>
                                <tbody id="importPreviewBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveBatchImport()" id="saveImportBtn" disabled>
                        <i class="bi bi-save"></i> 保存到数据库
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 密码验证模态框 -->
    <div class="modal fade" id="passwordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-shield-lock me-2"></i>敏感信息保护
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        此客户信息包含敏感数据，需要输入保护密码才能查看完整信息。
                    </div>
                    <div class="mb-3">
                        <label class="form-label">保护密码</label>
                        <input type="password" class="form-control" id="protectionPassword" placeholder="请输入保护密码">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="verifyPassword()">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 文件上传批量导入模态框 -->
    <div class="modal fade" id="fileUploadModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-max-70">
            <div class="modal-content import-modal">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-upload me-2"></i>文件批量导入客户信息
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="import-upload-wrapper mb-4">
                        <div class="file-upload-area" id="fileUploadArea">
                            <div class="file-upload-content">
                                <i class="bi bi-cloud-upload file-upload-icon"></i>
                                <h6 class="import-dropzone-title">拖拽文件到此处或点击下方按钮选择文件</h6>
                                <p class="import-dropzone-desc">支持 Excel（.xlsx、.xls）与 CSV（.csv，UTF-8）格式文件，可同时选择多个文件批量导入。</p>
                                <div class="import-dropzone-actions">
                                    <label for="fileInput" class="btn btn-primary" id="selectFileBtn" style="pointer-events: auto; position: relative; z-index: 10; cursor: pointer; margin: 0;">
                                    <i class="bi bi-folder2-open"></i> 选择文件
                                        <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" multiple style="position: absolute; opacity: 0; width: 0; height: 0; overflow: hidden;">
                                    </label>
                                    <button class="btn btn-outline-secondary" type="button" onclick="resetImportFileSelection(); return false;" style="pointer-events: auto; position: relative; z-index: 10;">
                                        <i class="bi bi-arrow-counterclockwise"></i> 清空选择
                                </button>
                            </div>
                            </div>
                        </div>
                        <div class="import-upload-hint">
                            <i class="bi bi-shield-check"></i>
                            系统会自动校验重复数据并提示导入成功或失败的详细原因
                        </div>
                    </div>

                    <div class="import-preview-grid">
                        <div id="filePreview" class="import-preview-card" style="display: none;">
                            <div class="import-preview-card-header">
                                <h6 class="mb-0">文件预览</h6>
                                <span class="text-muted small">支持多文件导入，您可以在下方列表中替换或移除文件</span>
                            </div>
                        <div class="table-responsive">
                                <table class="table table-sm table-hover align-middle mb-0">
                                    <thead>
                                    <tr>
                                        <th>文件名</th>
                                        <th>文件类型</th>
                                        <th>文件大小</th>
                                        <th>状态</th>
                                            <th class="text-center">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="filePreviewBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                        <div id="dataPreview" class="import-preview-card" style="display: none;">
                            <div class="import-preview-card-header">
                                <h6 class="mb-0">数据预览</h6>
                                <span class="text-muted small">仅展示前10行预览，导入时将对全部数据进行完整校验</span>
                            </div>
                        <div class="table-responsive">
                                <table class="table table-sm table-hover align-middle mb-0">
                                    <thead>
                                    <tr>
                                        <th>客户名称</th>
                                        <th>联系人</th>
                                        <th>电话</th>
                                        <th>客户类型</th>
                                            <th>职务</th>
                                            <th>QQ/微信</th>
                                            <th>合作内容</th>
                                        <th>地区</th>
                                        <th>状态</th>
                                    </tr>
                                </thead>
                                <tbody id="dataPreviewBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                </div>
                <div class="modal-footer justify-content-end">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-success" onclick="saveUploadedData()" id="saveUploadedBtn">
                        <i class="bi bi-cloud-upload"></i> 导入到数据库
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/communications.js"></script>
    <script src="/js/customers.js"></script>
    <script src="/lib/bootstrap/bootstrap.bundle.min.js"></script>
</body>
</html>